"use strict";function readJSON(e,t){var n=new XMLHttpRequest;n.overrideMimeType("application/json"),n.open("GET",e,!0),n.onreadystatechange=function(){4===n.readyState&&"200"==n.status&&t(n.responseText)},n.send(null)}var vm=new Vue({el:"#app",data:{works:[]},mounted:function(){var t=this;readJSON("../json/front-end.json",function(e){t.works=JSON.parse(e)})}});jQuery(document).ready(function(d){var e=d(".cd-horizontal-timeline"),f=60;function c(e,t,n){var i=w(e.eventsWrapper),r=Number(e.timelineWrapper.css("width").replace("px",""));"next"==n?u(e,i-r+f,r-t):u(e,i+r-f)}function v(e,t,n){var i,r,a,l,s,o,p,d,f,c,v=e.eventsContent.find(".selected");0<("next"==n?v.next():v.prev()).length&&(i=e.eventsWrapper.find(".selected"),m(r="next"==n?i.parent("li").next("li").children("a"):i.parent("li").prev("li").children("a"),e.fillingLine,t),g(r,e.eventsContent),r.addClass("selected"),i.removeClass("selected"),h(r),a=n,l=r,s=e,p=window.getComputedStyle(l.get(0),null),d=Number(p.getPropertyValue("left").replace("px","")),f=Number(s.timelineWrapper.css("width").replace("px","")),o=Number(s.eventsWrapper.css("width").replace("px","")),c=w(s.eventsWrapper),("next"==a&&f-c<d||"prev"==a&&d<-c)&&u(s,f/2-d,f-o))}function u(e,t,n){t=0<t?0:t,s(e.eventsWrapper.get(0),"translateX",(t=void 0!==n&&t<n?n:t)+"px"),0==t?e.timelineNavigation.find(".prev").addClass("inactive"):e.timelineNavigation.find(".prev").removeClass("inactive"),t==n?e.timelineNavigation.find(".next").addClass("inactive"):e.timelineNavigation.find(".next").removeClass("inactive")}function m(e,t,n){var i=window.getComputedStyle(e.get(0),null),r=i.getPropertyValue("left"),a=i.getPropertyValue("width"),l=(r=Number(r.replace("px",""))+Number(a.replace("px",""))/2)/n;s(t.get(0),"scaleX",l)}function g(e,t){var n,i,r=e.data("date"),a=t.find(".selected"),l=t.find('[data-date="'+r+'"]'),s=l.height();i=l.index()>a.index()?(n="selected enter-right","leave-left"):(n="selected enter-left","leave-right"),l.attr("class",n),a.attr("class",i).one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){a.removeClass("leave-right leave-left"),l.removeClass("enter-left enter-right")}),t.css("height",s+"px")}function h(e){e.parent("li").prevAll("li").children("a").addClass("older-event").end().end().nextAll("li").children("a").removeClass("older-event")}function w(e){var t,n=window.getComputedStyle(e.get(0),null),i=n.getPropertyValue("-webkit-transform")||n.getPropertyValue("-moz-transform")||n.getPropertyValue("-ms-transform")||n.getPropertyValue("-o-transform")||n.getPropertyValue("transform");return t=0<=i.indexOf("(")?(i=(i=(i=i.split("(")[1]).split(")")[0]).split(","))[4]:0,Number(t)}function s(e,t,n){e.style["-webkit-transform"]=t+"("+n+")",e.style["-moz-transform"]=t+"("+n+")",e.style["-ms-transform"]=t+"("+n+")",e.style["-o-transform"]=t+"("+n+")",e.style.transform=t+"("+n+")"}function x(e,t){return Math.round(t-e)}function y(e){for(var t=e.offsetTop,n=e.offsetLeft,i=e.offsetWidth,r=e.offsetHeight;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+r>window.pageYOffset&&n+i>window.pageXOffset}function C(){return window.getComputedStyle(document.querySelector(".cd-horizontal-timeline"),"::before").getPropertyValue("content").replace(/'/g,"").replace(/"/g,"")}0<e.length&&e.each(function(){var e,n,t=d(this),r={};r.timelineWrapper=t.find(".events-wrapper"),r.eventsWrapper=r.timelineWrapper.children(".events"),r.fillingLine=r.eventsWrapper.children(".filling-line"),r.timelineEvents=r.eventsWrapper.find("a"),r.timelineDates=(e=r.timelineEvents,n=[],e.each(function(){var e=d(this).data("date").split("/"),t=new Date(e[2],e[1]-1,e[0]);n.push(t)}),n),r.eventsMinLapse=function(e){var t=[];for(i=1;i<e.length;i++){var n=x(e[i-1],e[i]);t.push(n)}return Math.min.apply(null,t)}(r.timelineDates),r.timelineNavigation=t.find(".cd-timeline-navigation"),r.eventsContent=t.children(".events-content"),function(e,t){for(i=0;i<e.timelineDates.length;i++){var n=x(e.timelineDates[0],e.timelineDates[i]),r=Math.round(n/e.eventsMinLapse)+2;e.timelineEvents.eq(i).css("left",r*t+"px")}}(r,f);var a,l,s,o,p=(l=f,s=x((a=r).timelineDates[0],a.timelineDates[a.timelineDates.length-1])/a.eventsMinLapse,o=(s=Math.round(s)+4)*l,a.eventsWrapper.css("width",o+"px"),m(a.timelineEvents.eq(0),a.fillingLine,o),o);t.addClass("loaded"),r.timelineNavigation.on("click",".next",function(e){e.preventDefault(),c(r,p,"next")}),r.timelineNavigation.on("click",".prev",function(e){e.preventDefault(),c(r,p,"prev")}),r.eventsWrapper.on("click","a",function(e){e.preventDefault(),r.timelineEvents.removeClass("selected"),d(this).addClass("selected"),h(d(this)),m(d(this),r.fillingLine,p),g(d(this),r.eventsContent)}),r.eventsContent.on("swipeleft",function(){"mobile"==C()&&v(r,p,"next")}),r.eventsContent.on("swiperight",function(){"mobile"==C()&&v(r,p,"prev")}),d(document).keyup(function(e){"37"==e.which&&y(t.get(0))?v(r,p,"prev"):"39"==e.which&&y(t.get(0))&&v(r,p,"next")})})});